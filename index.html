<!doctype html>
<html lang="en">
    <head>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-PY8Y2NJ04V"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-PY8Y2NJ04V');
        </script>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <meta name="description" content="MeshLabJS: the javascript mesh processing tool. Built using vcg library, emscripten and webgl. Developed by the Visual Computing Lab of ISTI - CNR and by the students of the FGT course.">
        <title>SpineView</title>
        <link rel="icon" href="img/favicon.png" type="image/x-icon"/>             
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.min.css">
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.structure.min.css">
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.theme.min.css">       
        <link rel="stylesheet" href="css/style.css">
        
        <script src="js/include/jquery-ui-1.11.4.custom/external/jquery/jquery.js"></script>        
        <script src="js/include/jquery-ui-1.11.4.custom/jquery-ui.js"></script>

        <script src="js/include/colpick/js/colpick.js"></script>
        <link rel="stylesheet" href="js/include/colpick/css/colpick.css">

        <script src="js/include/three.min.js"></script>
        <script src="js/include/stats.js"></script>
        <script src="js/include/TrackballControls.js"></script>
        
        <script src="js/include/FileSaver/FileSaver.min.js"></script>
        <script src="js/include/canvas-toBlob/canvas-toBlob.js"></script>

        <script src="js/mlj/MLJ.js"></script>
        
        <script src="js/mlj/util/Util.js"></script>
        
        <script src="js/mlj/core/Core.js"></script>
        <script src="js/mlj/core/Layer.js"></script>
        <script src="js/mlj/core/Scene.js"></script>
        <script src="js/mlj/core/File.js"></script>
        
        <script src="js/mlj/gui/Gui.js"></script>
        <script src="js/mlj/gui/Param.js"></script>
        <script src="js/mlj/gui/Component.js"></script>
        <script src="js/mlj/gui/Widget.js"></script>
        <script src="js/mlj/gui/SceneBar.js"></script>
        <script src="js/mlj/gui/SearchTool.js"></script>
        <script src="js/mlj/gui/LayersPane.js"></script>
        <script src="js/mlj/gui/TabbedPane.js"></script>
        <script src="js/mlj/gui/Log.js"></script>
        <script src="js/mlj/gui/Logo.js"></script> 
       
        <script src="js/mlj/gui/Info.js"></script>                    

        <script src="js/mlj/core/plugin/Plugin.js"></script>
        <script src="js/mlj/core/plugin/Filter.js"></script>
        <script src="js/mlj/core/plugin/BaseRendering.js"></script>
        <script src="js/mlj/core/plugin/GlobalRendering.js"></script>
        <script src="js/mlj/core/plugin/Rendering.js"></script>
        <script src="js/mlj/core/plugin/Manager.js"></script>
        
        <script src="js/mlj/plugins/filters/Transform.js"></script> 
        <script src="js/mlj/plugins/filters/Refine.js"></script>
        <script src="js/mlj/plugins/filters/Selection.js"></script>
        <script src="js/mlj/plugins/filters/Create.js"></script>
        <script src="js/mlj/plugins/filters/FuncParser.js"></script>
        <script src="js/mlj/plugins/filters/Sampling.js"></script>
        <script src="js/mlj/plugins/filters/Meshing.js"></script>
        <script src="js/mlj/plugins/filters/Measure.js"></script>
        <script src="js/mlj/plugins/filters/Color.js"></script>
        <script src="js/mlj/plugins/filters/Quality.js"></script>
        
        <script src="js/mlj/plugins/rendering/Axes.js"></script> 
        <script src="js/mlj/plugins/rendering/BackgroundGrid.js"></script> 
        <script src="js/mlj/plugins/rendering/Global.js"></script> 
        <script src="js/mlj/plugins/rendering/ColorWheel.js"></script> 
        <script src="js/mlj/plugins/rendering/Box.js"></script> 
        <script src="js/mlj/plugins/rendering/Points.js"></script> 
        <script src="js/mlj/plugins/rendering/Wire.js"></script> 
        <script src="js/mlj/plugins/rendering/Filled.js"></script>      
        <script src="js/mlj/plugins/rendering/Selected.js"></script> 
        <script src="js/mlj/plugins/rendering/Normals.js"></script> 
        <script src="js/mlj/plugins/rendering/BoundaryEdges.js"></script>
        <script src="js/mlj/plugins/rendering/Histogram.js"></script>
        <script src="js/mlj/plugins/rendering/RadianceScaling.js"></script>
        <script src="js/mlj/plugins/rendering/ScreenSpaceAmbientOcclusion.js"></script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-t6zbvU0BjKz7m+8XHJL7pDUTnJZdA1Z8cg+jjIV7+e5g5zlf7Lb9Q1Hpb+5MwkQ1bfJvpZmp+UNPThHKIvBkCg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script async src="js/generated/MeshLabCppCore.js"></script>

        <script src="js/MeshLabJS.js"></script>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


        <style>

          nav {
            background-color: #E0E0E0;
            overflow: hidden;
            border-top: 1px solid blue;
            border-bottom: 1px solid blue;
      
        }
      
        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
      
        nav li {
            float: left;
        }
      
        nav li a {
            display: block;
            color: black;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            border: #111;
            border-width: 5;
        }
      
        nav li a:hover {
            background-color: #111;
            color: #E0E0E0;
        }
      
        .logo {
            float: right;
        
        }
      
        .logo img {
            height: 50%;
            width: 50%;
        }
      </style>
    </head>
    <body>    
      <nav>
        <ul>
    
    
              <li>
                
                  <a href="#" data-bs-toggle="modal" data-bs-target="#contributionsModal" >
                      <i class="fas fa-hand-holding-heart"></i> Contributions
                  </a>
              </li>
              <li>
                <a href="#" data-bs-toggle="modal" data-bs-target="#docModal" style="border-left: 1px solid blue;">
                    <i class="fas fa-code"></i> Documentation&nbsp;
                </a>
            </li>
              <li>
                  <a href="#" data-bs-toggle="modal" data-bs-target="#downloadsModal" style="border-right: 1px solid; border-left: 1px solid blue;">
                      <i class="fas fa-download"></i> Downloads&nbsp;&nbsp;    
                  </a>
              </li>
              <li class="logo" style="margin-right: -10%; margin-top: 3px;">
                  <img src="spineview.png" alt="Logo">
              </li>
          </ul>
      </nav>
    
      <!-- Contributions Modal -->
      <div class="modal fade" id="contributionsModal" tabindex="-1" aria-labelledby="contributionsModalLabel"
      aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="contributionsModalLabel">Contributions</h5>
              </div>



              <div class="modal-body">
                <p>
                    <b>Authors</b>
                    </br>Estefano Munoz-Moya <sup>1, ∗</sup>,
                    </br>Morteza Rasouligandomani <sup>2</sup>,
                    </br>Carlos Ruiz Wills <sup>2</sup>,
                    </br>Francis Chemorion <sup>1, 2</sup>,
                    </br>Gemma Piella <sup>2</sup>, and
                    </br>Jérôme Noailly <sup>1</sup>
                </p>
                <p>
                    <b>Affiliations</b>
                    </br>1. BCN MedTech, Department of Information and Communication Technologies, Universitat Pompeu Fabra, Barcelona, Spain
                    </br>2. IT, Department of Information Technology, InSilicoTrials Technologies, Trieste, Italy
                </p>
            </div>
            




          </div>
      </div>
    </div>
    
    <!-- API Modal -->
    <div class="modal fade" id="docModal" tabindex="-1" aria-labelledby="docModalLabel" aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="apiModalLabel">Abstract</h5>
              </div>
              <div class="modal-body">
    <p>
    
        Intervertebral Disc (IVD) Degeneration (IDD) is a significant health concern, potentially 4 influenced by mechanotransduction. However, The link between IVD phenotypes and 5 mechanical behavior remains underexplored. This study introduces an innovative method 6 to transform a calibrated structured IVD finite element (FE) mesh into 169 patient-specific 7 (PS) models through mesh morphing. It aims to identify interplay among morphological 8 and mechanical features potentially relevant in IDD, creating a unique model repository 9 for the scientific community. Under the Disc4All initiative, segmented magnetic resonance 10 images from the former project MySpine were acquired to generate 169 PS FE models with 11 structured hexahedral meshes through a morphing algorithm employing the Bayesian 12 Coherent Point Drift ++ (BCPD++) technique. The cartilage endplate (CEP) shape was 13 estimated to assess its role in IVD-vertebra interfaces, creating accurate real disc meshes 14 and ensuring simulation convergence. Machine learning methods such as LR, SVR, and 15 XGBoostR were applied to explore the correlations between morphology and mechanics. 16 A total of 169 IVD PS FE models were generated, maintaining the functional integrity 17 of the hexahedral mesh. The BCPD++ achieved FE model shapes with AF and NP 18 similarity scores of 92.06% and 92.10%, respectively, compared to the segmented images. 19 Validation of the constitutive model against literature data showed a minor relative error of 20 5.20%. Our analysis revealed sophisticated relationships between local morphologies and 21 mechanical responses, highlighting the roles of disc heights, volumes, and CEP diffusion 22 distances. Furthermore, creating an extensive model repository that captures individual 23 disc characteristics is expected to significantly contribute to the scientific community for 24 a broad spectrum of research and applications, advancing the understanding of IDD.  
    </p>
              </div>
          </div>
      </div>
    </div>
    
    <!-- Downloads Modal -->
    <div class="modal fade" id="downloadsModal" tabindex="-1" aria-labelledby="downloadsModalLabel"
      aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="downloadsModalLabel">Downloads</h5>
              </div>
              <div class="modal-body">
             <a href="https://zenodo.org/records/8325042">  <button class="btn btn-primary">Complete .INP file download</button></a>
    
          </div>
      </div>
    </div>

  

  <script >
    const urlParams = new URLSearchParams(window.location.search);
    let filenamePrefix = urlParams.get('filenamePrefix') || 'GENERIC_L4L5';

    // Define common suffixes for the filenames
    const suffixes = [
        "_AF.stl",
        "_CEP.stl",
        "_NP.stl",
    ];

    // Map suffixes to colors
    const suffixColors = {
        "_AF.stl": "red",
        "_CEP.stl": "blue",
        "_NP.stl": "green",
    };

    // Generate filenames based on the prefix and common suffixes
    const filenames = suffixes.map(suffix => `${filenamePrefix}${suffix}`);
    
    function openFiles() {
        filenames.forEach((filename) => {
            MLJ.core.File.openMeshFileFromUrl(filename);
        });
    }

// Custom function to apply color to a mesh
function applyColorToMesh(mesh, colorHex) {
    // Check if the mesh and its material are valid
    if (mesh && mesh.material) {
        mesh.material.color = new THREE.Color(colorHex);
        mesh.material.needsUpdate = true;
    } else {
        // console.error("Mesh or material not found for color application.");
    }
}

// Modified event handler
$(document).on("MeshFileOpened", function (event, meshFile) {
    const filename = meshFile.fileName;
    const suffix = filename.substring(filename.lastIndexOf('_'));
    const color = suffixColors[suffix] || "defaultColor";

    // Apply color to the mesh
    applyColorToMesh(meshFile.threeMesh, color);

    // Re-render the scene to reflect color changes
    MLJ.core.Scene.render();
});


    MLJ.core.plugin.Manager.run();
    MLJ.gui.makeGUI("");
    Module['onRuntimeInitialized'] = function() {
        openFiles();
    };
</script>








        
        
        
    </body>


</html>

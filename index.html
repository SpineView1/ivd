<!doctype html>
<html lang="en">
    <head>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-PY8Y2NJ04V"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-PY8Y2NJ04V');
        </script>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <meta name="description" content="MeshLabJS: the javascript mesh processing tool. Built using vcg library, emscripten and webgl. Developed by the Visual Computing Lab of ISTI - CNR and by the students of the FGT course.">
        <title>SpineView</title>
        <link rel="icon" href="img/favicon.png" type="image/x-icon"/>             
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.min.css">
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.structure.min.css">
        <link rel="stylesheet" href="js/include/jquery-ui-1.11.4.custom/jquery-ui.theme.min.css">       
        <link rel="stylesheet" href="css/style.css">
        <script src="https://kit.fontawesome.com/3b924a323a.js" crossorigin="anonymous"></script>

        <script src="js/include/jquery-ui-1.11.4.custom/external/jquery/jquery.js"></script>        
        <script src="js/include/jquery-ui-1.11.4.custom/jquery-ui.js"></script>

        <script src="js/include/colpick/js/colpick.js"></script>
        <link rel="stylesheet" href="js/include/colpick/css/colpick.css">

        <script src="js/include/three.min.js"></script>
        <script src="js/include/stats.js"></script>
        <script src="js/include/TrackballControls.js"></script>
        
        <script src="js/include/FileSaver/FileSaver.min.js"></script>
        <script src="js/include/canvas-toBlob/canvas-toBlob.js"></script>

        <script src="js/mlj/MLJ.js"></script>
        
        <script src="js/mlj/util/Util.js"></script>
        
        <script src="js/mlj/core/Core.js"></script>
        <script src="js/mlj/core/Layer.js"></script>
        <script src="js/mlj/core/Scene.js"></script>
        <script src="js/mlj/core/File.js"></script>
        
        <script src="js/mlj/gui/Gui.js"></script>
        <script src="js/mlj/gui/Param.js"></script>
        <script src="js/mlj/gui/Component.js"></script>
        <script src="js/mlj/gui/Widget.js"></script>
        <script src="js/mlj/gui/SceneBar.js"></script>
        <script src="js/mlj/gui/SearchTool.js"></script>
        <script src="js/mlj/gui/LayersPane.js"></script>
        <script src="js/mlj/gui/TabbedPane.js"></script>
        <script src="js/mlj/gui/Log.js"></script>
        <script src="js/mlj/gui/Logo.js"></script> 
       
        <script src="js/mlj/gui/Info.js"></script>                    

        <script src="js/mlj/core/plugin/Plugin.js"></script>
        <script src="js/mlj/core/plugin/Filter.js"></script>
        <script src="js/mlj/core/plugin/BaseRendering.js"></script>
        <script src="js/mlj/core/plugin/GlobalRendering.js"></script>
        <script src="js/mlj/core/plugin/Rendering.js"></script>
        <script src="js/mlj/core/plugin/Manager.js"></script>
        
        <script src="js/mlj/plugins/filters/Transform.js"></script> 
        <script src="js/mlj/plugins/filters/Refine.js"></script>
        <script src="js/mlj/plugins/filters/Selection.js"></script>
        <script src="js/mlj/plugins/filters/Create.js"></script>
        <script src="js/mlj/plugins/filters/FuncParser.js"></script>
        <script src="js/mlj/plugins/filters/Sampling.js"></script>
        <script src="js/mlj/plugins/filters/Meshing.js"></script>
        <script src="js/mlj/plugins/filters/Measure.js"></script>
        <script src="js/mlj/plugins/filters/Color.js"></script>
        <script src="js/mlj/plugins/filters/Quality.js"></script>

        <script src="js/mlj/plugins/rendering/Axes.js"></script> 
        <script src="js/mlj/plugins/rendering/BackgroundGrid.js"></script> 
        <script src="js/mlj/plugins/rendering/Global.js"></script> 
        <script src="js/mlj/plugins/rendering/ColorWheel.js"></script> 
        <script src="js/mlj/plugins/rendering/Box.js"></script> 
        <script src="js/mlj/plugins/rendering/Points.js"></script> 
        <script src="js/mlj/plugins/rendering/Wire.js"></script> 
        <script src="js/mlj/plugins/rendering/Filled.js"></script>      
        <script src="js/mlj/plugins/rendering/Selected.js"></script> 
        <script src="js/mlj/plugins/rendering/Normals.js"></script> 
        <script src="js/mlj/plugins/rendering/BoundaryEdges.js"></script>
        <script src="js/mlj/plugins/rendering/Histogram.js"></script>
        <script src="js/mlj/plugins/rendering/RadianceScaling.js"></script>
        <script src="js/mlj/plugins/rendering/ScreenSpaceAmbientOcclusion.js"></script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script async src="js/generated/MeshLabCppCore.js"></script>

        <script src="js/MeshLabJS.js"></script>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

        

        <style>

          nav {
            background-color: #E0E0E0;
            overflow: hidden;
            border-top: 1px solid blue;
            border-bottom: 1px solid blue;
      
        }
      
        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
      
        nav li {
            float: left;
        }
      
        nav li a {
            display: block;
            color: black;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            border: #111;
            border-width: 5;
        }
      
        nav li a:hover {
            background-color: #111;
            color: #E0E0E0;
        }
      
        .logo {
            float: right;
        
        }
      
        .logo img {
            height: 50%;
            width: 50%;
        }
        
      </style>
    </head>
    <body>    
      <nav>
        <ul>
              <li>
                  <a href="#" data-bs-toggle="modal" data-bs-target="#contributionsModal" >
                      <i class="fas fa-hand-holding-heart"></i> Contributions
                  </a>
              </li>
              <li>
                <a href="#" data-bs-toggle="modal" data-bs-target="#docModal" style="border-left: 1px solid blue;">
                    <i class="fas fa-code"></i> Documentation;
                </a>
            </li>
              <li>
                  <a href="#" data-bs-toggle="modal" data-bs-target="#downloadsModal" style="border-right: 1px solid; border-left: 1px solid blue;">
                      <i class="fas fa-download"></i> Downloads    
                  </a>
              </li>
              <li id="modelNameDisplay" style="color: #111; margin-top: 15px; display: inline-flex; align-items: center; margin-right: 15px; margin-left: 15px;">
                <i class="fas fa-cube" style="margin-right: 5px;"></i>Model: <span id="modelName">GENERIC</span>
            </li>
            <li id="modelLevelDisplay" style="color: #111; margin-top: 15px; display: inline-flex; align-items: center;">
                <i class="fas fa-layer-group" style="margin-right: 5px;"></i>Level: <span id="modelLevel">L4L5</span>
            </li>
            
              <li class="logo" style="margin-top: 3px; margin-right: -9%;">
                  <img src="spineview.png" alt="Logo">
              </li>
          </ul>
      </nav>
    
      <!-- Contributions Modal -->
      <div class="modal fade" id="contributionsModal" tabindex="-1" aria-labelledby="contributionsModalLabel"
      aria-hidden="true" >
      <div class="modal-dialog">
          <div class="modal-content" style="width: 105%;">
              <div class="modal-header">
                  <h5 class="modal-title" id="contributionsModalLabel">Contributions</h5>
              </div>


              <div class="modal-body">
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
                <style>
                    table {
                        width: 80%;
                        border-collapse: collapse;
                    }
                    th, td {
                        text-align: center;
                        border: 1px solid #ddd;
                        padding: 8px;
                    }
                    th {
                        background-color: #f2f2f2;
                    }
                    a {
                        display: inline-block;
                        margin: 0 5px;
                    }
                    
                </style>
                <table>
                    <tr>
                        <th>Author</th>
                        <th><i class="fas fa-home" title="Home"></i></th>
                        <th><i class="fas fa-envelope" title="Email"></i></th>
                        <th><i class="fa-brands fa-square-x-twitter"></i></th>
                        <th><i class="fab fa-github" title="GitHub"></i></th>
                        <th><i class="fas fa-graduation-cap" title="Google Scholar"></i></th>
                        <th><i class="fab fa-orcid" title="ORCID"></i></th>
                        <th><i class="fab fa-researchgate" title="ResearchGate"></i></th>
                        <th><i class="fab fa-linkedin" title="LinkedIn"></i></th>
                        <th><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 599 260">
                            <g fill="none" fill-rule="evenodd">
                              <path fill="#000" d="M483 180.265V249h-26V60h26v14.735C495.302 64.002 511.392 57.5 529 57.5c38.66 0 70 31.34 70 70s-31.34 70-70 70c-17.608 0-33.698-6.502-46-17.235zm46-6.765c-25.957 0-47-21.043-47-47s21.043-47 47-47 47 21.043 47 47-21.043 47-47 47zM0 0h25v156c0 10.667 7.667 16 23 16 1.333 4.667 4.333 11.667 9 21H34c-21 0-34-21-34-37V0zm382 197.5c-38.66 0-70-31.34-70-70s31.34-70 70-70 70 31.34 70 70-31.34 70-70 70zm0-24c25.957 0 47-21.043 47-47s-21.043-47-47-47-47 21.043-47 47 21.043 47 47 47z"/>
                              <path fill="#DA2032" d="M178 194c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64 35.346 0 64 28.654 64 64 0 35.346-28.654 64-64 64zm0-22c27.062 0 49-21.938 49-49s-21.938-49-49-49-49 21.938-49 49 21.938 49 49 49z"/>
                              <path fill="#F7941E" d="M178 214c-46.392 0-84-37.608-84-84s37.608-84 84-84 84 37.608 84 84-37.608 84-84 84zm3.5-18c39.488 0 71.5-32.012 71.5-71.5S220.988 53 181.5 53 110 85.012 110 124.5s32.012 71.5 71.5 71.5z"/>
                              <path fill="#D5CD25" d="M178 236c-58.542 0-106-47.458-106-106S119.458 24 178 24s106 47.458 106 106-47.458 106-106 106zm4-21c49.706 0 90-40.294 90-90s-40.294-90-90-90-90 40.294-90 90 40.294 90 90 90z"/>
                              <path fill="#757600" d="M178 260c-71.797 0-130-58.203-130-130S106.203 0 178 0s130 58.203 130 130-58.203 130-130 130zm5.5-21c61.027 0 110.5-49.473 110.5-110.5S244.527 18 183.5 18 73 67.473 73 128.5 122.473 239 183.5 239z"/>
                            </g>
                          </svg></th>
                    </tr>
                    <!-- Example row for Estefano Munoz-Moya -->
                    <tr>
                        <td>Estefano Munoz-Moya <sup>1, ∗</sup></td>
                        <td><a href="https://estefano23.github.io/">X</a></td>
                        <td><a href="mailto:estefano.munoz.moya@gmail.com">X</a></td>
                        <td><a href="https://x.com/estefanoMunoz23">X</a></td>
                        <td><a href="https://github.com/estefano23/">X</a></td>
                        <td><a href="https://scholar.google.com/citations?user=eT1mgk0AAAAJ&hl">X</a></td>
                        <td><a href="https://orcid.org/0000-0001-5222-4071">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Estefano-Munoz-Moya">X</a></td>
                        <td><a href="https://www.linkedin.com/in/estefano-munoz-moya/">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/1555265/publications">X</a></td>
                    </tr>
                    <!-- Add rows for other authors in the same format -->
                    <tr>
                        <td>Carlos Ruiz Wills <sup>2</sup></td>
                        <td><a href="https://www.upf.edu/web/simbiosys/people/-/asset_publisher/XtdsMnNRpXfH/content/ruiz-wills-carlos/maximized">X</a></td>
                        <td><a href="mailto:carlos.ruiz@upf.edu">X</a></td>
                        <td><a href="https://twitter.com/cruizwills">X</a></td>
                        <td><a href="#">X</a></td>
                        <td><a href="https://scholar.google.com/citations?user=sCaJkkoAAAAJ">X</a></td>
                        <td><a href="https://orcid.org/0000-0002-7475-8557">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Carlos-Ruiz-Wills">X</a></td>
                        <td><a href="https://es.linkedin.com/in/carlos-ruiz-wills-23924052">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/588063/publications">X</a></td>
                    </tr>
                    <tr>
                        <td>Morteza Rasouligandomani<sup>2</sup></td>
                        <td><a href="https://www.upf.edu/web/simbiosys/people/-/asset_publisher/2h1s00p2oc8E/content/rasouligandomani-morteza/maximized">X</a></td>
                        <td><a href="mailto:morteza.rasouli@upf.edu">X</a></td>
                        <td><a href="https://twitter.com/MortezaRG">X</a></td>
                        <td><a href="#">X</a></td>
                        <td><a href="https://scholar.google.com/citations?user=GIiNE5MAAAAJ&hl=en&oi=sra">X</a></td>
                        <td><a href="https://orcid.org/0000-0003-2396-2328">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Morteza-Rasouligandomani">X</a></td>
                        <td><a href="https://www.linkedin.com/in/morteza-rasouligandomani-4a68065a">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/2138876/publications">X</a></td>
                    </tr>
                    <tr>
                        <td>Francis Chemorion<sup>1,2</sup></td>
                        <td><a href="https://disc4all.upf.edu/bio/francis-chemorion/">X</a></td>
                        <td><a href="mailto:francis.chemorion01@estudiant.upf.edu">X</a></td>
                        <td><a href="https://twitter.com/fkchemorion">X</a></td>
                        <td><a href="https://github.com/kchemorion">X</a></td>
                        <td><a href="https://scholar.google.com/citations?user=upAnje8AAAAJ&hl=en">X</a></td>
                        <td><a href="https://orcid.org/0000-0002-2099-0035">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Francis-Chemorion">X</a></td>
                        <td><a href="https://www.linkedin.com/in/francis-chemorion/">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/2449392/publications">X</a></td>
                    </tr>
                    <tr>
                        <td>Gemma Piella<sup>2</sup></td>
                        <td><a href="https://www.upf.edu/web/simbiosys/people/-/asset_publisher/dei3rtMP0xmk/content/piella-fenoy-gemma/maximized">X</a></td>
                        <td><a href="mailto:gemma.piella@upf.edu">X</a></td>
                        <td><a href="https://twitter.com/GemmaPiella">X</a></td>
                        <td><a href="#">X</a></td>
                        <td><a href="https://scholar.google.com/citations?user=Q6zjCpsAAAAJ&hl=en">X</a></td>
                        <td><a href="https://orcid.org/0000-0001-5236-5819">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Gemma-Piella">X</a></td>
                        <td><a href="https://www.linkedin.com/in/gemma-piella-a234b4/">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/383139/publications">X</a></td>
                    </tr>
                    <tr>
                        <td>Jérôme Noailly<sup>1</sup></td>
                        <td><a href="https://www.upf.edu/web/etic/computational-biology-and-biomedical-systems/-/asset_publisher/MKlA53ZqmAS8/content/noailly-j%C3%A9r%C3%B4me-bernard/maximized">X</a></td>
                        <td><a href="mailto:jerome.noailly@upf.edu">X</a></td>
                        <td><a href="https://twitter.com/jeromenoailly">X</a></td>
                        <td><a href="#">X</a></td>
                        <td><a href="https://scholar.google.es/citations?user=YFvwxpwAAAAJ&hl=ca&oi=sra">X</a></td>
                        <td><a href="https://orcid.org/0000-0003-3446-7621">X</a></td>
                        <td><a href="https://www.researchgate.net/profile/Jerome-Noailly-2">X</a></td>
                        <td><a href="https://www.linkedin.com/in/jnoailly/">X</a></td>
                        <td><a href="https://loop.frontiersin.org/people/59318/publications">X</a></td>
                    </tr>
                </table>
                <p>1. BCN MedTech, Department of Information and Communication Technologies, Universitat Pompeu Fabra, Barcelona, Spain<br>
                   2. IT, Department of Information Technology, InSilicoTrials Technologies, Trieste, Italy
                </p>
            </div>
          </div>
      </div>
    </div>
    
    <!-- API Modal -->
    <div class="modal fade" id="docModal" tabindex="-1" aria-labelledby="docModalLabel" aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="apiModalLabel">Abstract</h5>
              </div>
              <div class="modal-body">
    <p>
    
        Intervertebral Disc (IVD) Degeneration (IDD) is a significant health concern, potentially 4 influenced by mechanotransduction. However, The link between IVD phenotypes and 5 mechanical behavior remains underexplored. This study introduces an innovative method 6 to transform a calibrated structured IVD finite element (FE) mesh into 169 patient-specific 7 (PS) models through mesh morphing. It aims to identify interplay among morphological 8 and mechanical features potentially relevant in IDD, creating a unique model repository 9 for the scientific community. Under the Disc4All initiative, segmented magnetic resonance 10 images from the former project MySpine were acquired to generate 169 PS FE models with 11 structured hexahedral meshes through a morphing algorithm employing the Bayesian 12 Coherent Point Drift ++ (BCPD++) technique. The cartilage endplate (CEP) shape was 13 estimated to assess its role in IVD-vertebra interfaces, creating accurate real disc meshes 14 and ensuring simulation convergence. Machine learning methods such as LR, SVR, and 15 XGBoostR were applied to explore the correlations between morphology and mechanics. 16 A total of 169 IVD PS FE models were generated, maintaining the functional integrity 17 of the hexahedral mesh. The BCPD++ achieved FE model shapes with AF and NP 18 similarity scores of 92.06% and 92.10%, respectively, compared to the segmented images. 19 Validation of the constitutive model against literature data showed a minor relative error of 20 5.20%. Our analysis revealed sophisticated relationships between local morphologies and 21 mechanical responses, highlighting the roles of disc heights, volumes, and CEP diffusion 22 distances. Furthermore, creating an extensive model repository that captures individual 23 disc characteristics is expected to significantly contribute to the scientific community for 24 a broad spectrum of research and applications, advancing the understanding of IDD.  
    </p>
              </div>
          </div>
      </div>
    </div>
    
    <!-- Downloads Modal -->
    <div class="modal fade" id="downloadsModal" tabindex="-1" aria-labelledby="downloadsModalLabel"
      aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="downloadsModalLabel">Downloads</h5>
              </div>
              <div class="modal-body">
             <a href="https://zenodo.org/records/8325042">  <button class="btn btn-primary">Complete .INP file download</button></a>
    
          </div>
      </div>
    </div>

  

  <script >
    const urlParams = new URLSearchParams(window.location.search);
    let filenamePrefix = urlParams.get('filenamePrefix') || 'GENERIC_L4L5';

    let [modelName, modelLevel] = filenamePrefix.split('_');

    // Update the navigation bar with the model name and level
    document.getElementById('modelName').textContent = modelName;
    document.getElementById('modelLevel').textContent = modelLevel;
    // Define common suffixes for the filenames
    const suffixes = [
        "_AF.stl",
        "_CEP.stl",
        "_NP.stl",
    ];

    // Map suffixes to colors
    const suffixColors = {
        "_AF.stl": "#FF0000",
        "_CEP.stl": "#FF0000",
        "_NP.stl": "#FF0000",
    };

    // Generate filenames based on the prefix and common suffixes
    const filenames = suffixes.map(suffix => `${filenamePrefix}${suffix}`);
    
    function openFiles() {
        filenames.forEach((filename) => {
            MLJ.core.File.openMeshFileFromUrl(filename);
        });
    }

// Custom function to apply color to a mesh
function applyColorToMesh(mesh, colorHex) {
    // Check if the mesh and its material are valid
    if (mesh && mesh.material) {
        mesh.material.color = new THREE.Color(colorHex);
        mesh.material.needsUpdate = true;
    } else {
        // console.error("Mesh or material not found for color application.");
    }
}

// Modified event handler
$(document).on("MeshFileOpened", function (event, meshFile) {
    const filename = meshFile.fileName;
    const suffix = filename.substring(filename.lastIndexOf('_'));
    const color = suffixColors[suffix] || "defaultColor";

    // Apply color to the mesh
    applyColorToMesh(meshFile.threeMesh, color);

    // Re-render the scene to reflect color changes
    MLJ.core.Scene.render();
});


    MLJ.core.plugin.Manager.run();
    MLJ.gui.makeGUI("");
    Module['onRuntimeInitialized'] = function() {
        openFiles();
    };
</script>
  
        
    </body>


</html>
